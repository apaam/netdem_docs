\hypertarget{pynetdem_4_cylindrical_packing_8py-example}{}\doxysection{pynetdem\+\_\+4\+\_\+cylindrical\+\_\+packing.\+py}
This is an example of how to use the netdem library.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{00001\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{00002\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{00003\ dir\_path\ =\ os.path.dirname(os.path.realpath(\_\_file\_\_))}
\DoxyCodeLine{00004\ sys.path.append(dir\_path\ +\ \textcolor{stringliteral}{"{}/../../build/lib/"{}})}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{keyword}{import}\ pynetdem}
\DoxyCodeLine{00007\ pynetdem.omp\_set\_num\_threads(1)}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ sim\ =\ pynetdem.Simulation()}
\DoxyCodeLine{00010\ sim.domain\_manager.SetBound(-\/0.6,\ -\/0.6,\ -\/0.6,\ 0.6,\ 0.6,\ 0.6)}
\DoxyCodeLine{00011\ sim.domain\_manager.SetCellSpacing(0.3,\ 0.3,\ 0.3)}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ sim.dem\_solver.contact\_solver\_factory.settings.solver\_type\ \(\backslash\)}
\DoxyCodeLine{00014\ \ \ \ \ =\ pynetdem.ContactSolverSettings.SolverType.sdf}
\DoxyCodeLine{00015\ sim.dem\_solver.contact\_solver\_factory.settings.sdf\_potential\_type\ =\ 0}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ cnt\_model\ =\ pynetdem.LinearSpring(2.0e4,\ 1.0e4,\ 0.7,\ 0.5)}
\DoxyCodeLine{00018\ cnt\_model\_prt\ =\ sim.scene.InsertContactModel(cnt\_model)}
\DoxyCodeLine{00019\ sim.scene.SetNumberOfMaterials(1)}
\DoxyCodeLine{00020\ sim.scene.SetCollisionModel(0,\ 0,\ cnt\_model\_prt)}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ num\_insertion\ =\ 20}
\DoxyCodeLine{00023\ scale\ =\ pow(20.0\ /\ num\_insertion,\ 1.0\ /\ 3.0)}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{comment}{\#\ tri\_mesh\ =\ pynetdem.TriMesh()}}
\DoxyCodeLine{00026\ \textcolor{comment}{\#\ for\ i\ in\ range(5):}}
\DoxyCodeLine{00027\ \textcolor{comment}{\#\ \ \ \ \ tri\_mesh.InitFromSTL("{}data/copyleft/ballast/ballast\_"{}\ +\ str(i\ +\ 1)\ +\ "{}.stl"{})}}
\DoxyCodeLine{00028\ \textcolor{comment}{\#\ \ \ \ \ tri\_mesh.Decimate(400)}}
\DoxyCodeLine{00029\ \textcolor{comment}{\#\ \ \ \ \ tri\_mesh.AlignAxes()}}
\DoxyCodeLine{00030\ \textcolor{comment}{\#\ \ \ \ \ tri\_mesh.SetSize(0.01\ *\ scale)}}
\DoxyCodeLine{00031\ \textcolor{comment}{\#\ \ \ \ \ sim.scene.InsertShape(tri\_mesh)}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ level\_set\ =\ pynetdem.LevelSet()}
\DoxyCodeLine{00034\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(5):}
\DoxyCodeLine{00035\ \ \ \ \ level\_set.InitFromSTL(}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}data/copyleft/ballast/ballast\_"{}}\ +\ str(i\ +\ 1)\ +\ \textcolor{stringliteral}{"{}.stl"{}},\ 20)}
\DoxyCodeLine{00037\ \ \ \ \ level\_set.AlignAxes()}
\DoxyCodeLine{00038\ \ \ \ \ level\_set.SetSize(0.01\ *\ scale)}
\DoxyCodeLine{00039\ \ \ \ \ sim.scene.InsertShape(level\_set)}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ shape\_list\ =\ sim.scene.GetShapes()}
\DoxyCodeLine{00042\ pack\_generator\ =\ pynetdem.PackGenerator()}
\DoxyCodeLine{00043\ particle\_list\ =\ pack\_generator.GetGridPack(}
\DoxyCodeLine{00044\ \ \ \ \ 0.035,\ 0.035,\ 0.06,\ 0,\ 0,\ 0.07,\ 2,\ 2,\ 3,\ shape\_list)}
\DoxyCodeLine{00045\ \textcolor{keywordflow}{for}\ p\ \textcolor{keywordflow}{in}\ particle\_list:}
\DoxyCodeLine{00046\ \ \ \ \ p.SetVelocity(0,\ 0,\ -\/0.6)}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \textcolor{comment}{\#\ bottom\ wall}}
\DoxyCodeLine{00049\ plane\_bot\ =\ pynetdem.Plane(0,\ 0,\ -\/0.05,\ 0,\ 0,\ 1)}
\DoxyCodeLine{00050\ plane\_bot.SetExtent(0.1)}
\DoxyCodeLine{00051\ plane\_bot\_ptr\ =\ sim.scene.InsertShape(plane\_bot)}
\DoxyCodeLine{00052\ wall\_bot\ =\ pynetdem.Wall(plane\_bot\_ptr)}
\DoxyCodeLine{00053\ wall\_bot\_ptr\ =\ sim.scene.InsertWall(wall\_bot)}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \textcolor{comment}{\#\ membrane}}
\DoxyCodeLine{00056\ membrane\_wall\ =\ pynetdem.MembraneWall(0.025,\ 0.2,\ 0.0025)}
\DoxyCodeLine{00057\ membrane\_wall.facing\_outside\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{00058\ membrane\_wall.enable\_deformation\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{00059\ membrane\_wall.dump\_info\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{00060\ membrane\_wall.Init(sim)}
\DoxyCodeLine{00061\ membrane\_wall.SetRootPath(\textcolor{stringliteral}{"{}tmp/out\_tri\_comp/"{}})}
\DoxyCodeLine{00062\ membrane\_wall.SetSaveByCycles(100)}
\DoxyCodeLine{00063\ modifier\_ptr\ =\ sim.modifier\_manager.Insert(membrane\_wall)}
\DoxyCodeLine{00064\ modifier\_ptr.Enable()}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \textcolor{comment}{\#\ gravity}}
\DoxyCodeLine{00067\ grav\ =\ pynetdem.Gravity()}
\DoxyCodeLine{00068\ grav.Init(sim)}
\DoxyCodeLine{00069\ sim.modifier\_manager.Insert(grav)}
\DoxyCodeLine{00070\ sim.modifier\_manager.Enable(grav.label)}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \textcolor{comment}{\#\ save\ data}}
\DoxyCodeLine{00073\ data\_dumper\ =\ pynetdem.DataDumper()}
\DoxyCodeLine{00074\ data\_dumper.Init(sim)}
\DoxyCodeLine{00075\ data\_dumper.SetRootPath(\textcolor{stringliteral}{"{}tmp/out\_n"{}}\ +\ str(num\_insertion\ *\ 12)\ +\ \textcolor{stringliteral}{"{}/"{}})}
\DoxyCodeLine{00076\ data\_dumper.SetSaveByCycles(100)}
\DoxyCodeLine{00077\ data\_dumper.dump\_wall\_info\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{00078\ data\_dumper.dump\_contact\_info\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{00079\ data\_dumper.SaveShapeInfoAsSTL()}
\DoxyCodeLine{00080\ sim.modifier\_manager.Insert(data\_dumper)}
\DoxyCodeLine{00081\ sim.modifier\_manager.Enable(data\_dumper.label)}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(num\_insertion):}
\DoxyCodeLine{00084\ \ \ \ \ sim.scene.InsertParticle(particle\_list)}
\DoxyCodeLine{00085\ \ \ \ \ sim.Run(0.1)}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ sim.Run(2.0\ +\ 0.1\ *\ (20\ -\/\ num\_insertion))}

\end{DoxyCodeInclude}
 