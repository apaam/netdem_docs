\hypertarget{shape_8hpp_source}{}\doxysection{shape.\+hpp}
\label{shape_8hpp_source}\index{/Users/lzhshou/Documents/Research/myProjects/apaam/repo/netdem/src/shape/shape.hpp@{/Users/lzhshou/Documents/Research/myProjects/apaam/repo/netdem/src/shape/shape.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}stl\_model.hpp"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}utils\_math.hpp"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <nlohmann/json.hpp>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacenetdem}{netdem}}\ \{}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00026\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classnetdem_1_1_shape}{Shape}}\ \{}
\DoxyCodeLine{00027\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00031\ \ \ \textcolor{keyword}{enum}\ \mbox{\hyperlink{classnetdem_1_1_shape_aa97bccd1fe4043614c4b84a3f254a158}{Type}}\ \{}
\DoxyCodeLine{00032\ \ \ \ \ none,}
\DoxyCodeLine{00033\ \ \ \ \ point\_sphere,}
\DoxyCodeLine{00034\ \ \ \ \ sphere,}
\DoxyCodeLine{00035\ \ \ \ \ spherical\_harmonics,}
\DoxyCodeLine{00036\ \ \ \ \ trimesh,}
\DoxyCodeLine{00037\ \ \ \ \ trimesh\_convex,}
\DoxyCodeLine{00038\ \ \ \ \ ellipsoid,}
\DoxyCodeLine{00039\ \ \ \ \ polybezier,}
\DoxyCodeLine{00040\ \ \ \ \ triangle,}
\DoxyCodeLine{00041\ \ \ \ \ plane,}
\DoxyCodeLine{00042\ \ \ \ \ cylinder,}
\DoxyCodeLine{00043\ \ \ \ \ poly\_super\_ellipsoid,}
\DoxyCodeLine{00044\ \ \ \ \ poly\_super\_quadrics,}
\DoxyCodeLine{00045\ \ \ \ \ level\_set,}
\DoxyCodeLine{00046\ \ \ \ \ netsdf,}
\DoxyCodeLine{00047\ \ \ \ \ coded\_netsdf,}
\DoxyCodeLine{00048\ \ \ \ \ num\_shapes}
\DoxyCodeLine{00049\ \ \ \};}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \textcolor{comment}{//\ for\ tracking\ shape}}
\DoxyCodeLine{00052\ \ \ \textcolor{keywordtype}{int}\ \textcolor{keywordtype}{id}\{0\};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00053\ \ \ std::string\ \mbox{\hyperlink{classnetdem_1_1_shape_a4146ba9bcef64e03cf15d1efae7c7c31}{label}}\{\textcolor{stringliteral}{"{}default"{}}\};\ }
\DoxyCodeLine{00055\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classnetdem_1_1_shape_adafc3591f0c28b1bcc977294c9cd8748}{shape\_type}}\{0\};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00056\ \ \ std::string\ \mbox{\hyperlink{classnetdem_1_1_shape_a15f899d2a390b2bdf73f0f5e310b6b34}{shape\_name}}\{\textcolor{stringliteral}{"{}shape"{}}\};\ }
\DoxyCodeLine{00058\ \ \ \textcolor{comment}{//\ for\ particle\ properties.\ By\ default,\ it\ is\ assumed\ that\ the\ principal\ axes}}
\DoxyCodeLine{00059\ \ \ \textcolor{comment}{//\ of\ the\ shape\ primitives\ are\ aligned\ with\ the\ coordinate\ axes.}}
\DoxyCodeLine{00060\ \ \ \textcolor{keywordtype}{double}\ size\{1.0\},}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \mbox{\hyperlink{classnetdem_1_1_shape_a1812859ebfa70a57c31626dbc0552ae6}{volume}}\{0.5236\};\ }
\DoxyCodeLine{00062\ \ \ Mat3d\ \mbox{\hyperlink{classnetdem_1_1_shape_ac2e16aec8f9607d572c012ef9f2917d1}{inertia}}\{}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \{\{0.05236,\ 0,\ 0\},}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \{0,\ 0.05236,\ 0\},}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \{0,\ 0,\ 0.05236\}\}\};\ }
\DoxyCodeLine{00067\ \ \ \textcolor{comment}{//\ by\ default,\ particles\ are\ usually\ ball-\/like\ and\ we\ use\ bounding\ sphere}}
\DoxyCodeLine{00068\ \ \ \textcolor{comment}{//\ algorithm\ for\ the\ broad\ phase\ contact\ detection;\ if\ particles\ are\ seriously}}
\DoxyCodeLine{00069\ \ \ \textcolor{comment}{//\ elongated,\ bounding\ sphere\ may\ result\ in\ poor\ performance;\ as\ such,\ one\ can}}
\DoxyCodeLine{00070\ \ \ \textcolor{comment}{//\ enable\ the\ bounding\ aabb\ algorithm\ for\ efficiency.\ And,\ by\ default,\ walls}}
\DoxyCodeLine{00071\ \ \ \textcolor{comment}{//\ are\ usually\ represented\ by\ triangle\ mesh,\ and\ thus\ we\ use\ bounding\ aabb}}
\DoxyCodeLine{00072\ \ \ \textcolor{comment}{//\ algorithm\ for\ the\ broad\ phase\ contact\ detection.}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \textcolor{comment}{//\ for\ broad-\/phase\ contact\ detection:\ bounding\ sphere}}
\DoxyCodeLine{00075\ \ \ \textcolor{keywordtype}{double}\ bound\_sphere\_radius\{1.0\},\ skin\{0.05\},\ skin\_factor\{0.05\};}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \textcolor{comment}{//\ for\ broad-\/phase\ contact\ detection:\ bounding\ aabb}}
\DoxyCodeLine{00078\ \ \ Vec3d\ bound\_aabb\_min\{-\/0.5,\ -\/0.5,\ -\/0.5\},}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \mbox{\hyperlink{classnetdem_1_1_shape_a2abbd207dea9e86d154131624e217b96}{bound\_aabb\_max}}\{0.5,\ 0.5,}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.5\};\ }
\DoxyCodeLine{00082\ \ \ \textcolor{comment}{//\ for\ node-\/distance-\/potential\ contact\ solver}}
\DoxyCodeLine{00083\ \ \ \textcolor{keywordtype}{bool}\ use\_node\{\textcolor{keyword}{false}\};}
\DoxyCodeLine{00084\ \ \ \textcolor{keywordtype}{int}\ node\_num\{1000\};}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordtype}{double}\ node\_spacing\{std::sqrt(Math::PI\ /\ 1000.0)\};}
\DoxyCodeLine{00086\ \ \ VecXT<Vec3d>\ \mbox{\hyperlink{classnetdem_1_1_shape_aca813b26eea63d56642829360c7f5a3b}{nodes}};\ }
\DoxyCodeLine{00088\ \ \ \textcolor{comment}{//\ for\ determining\ contact\ solvers}}
\DoxyCodeLine{00089\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classnetdem_1_1_shape_a43558fbf3d8318948292aaf7c65f6c70}{is\_convex}}\{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \textcolor{keyword}{true}\};\ }
\DoxyCodeLine{00093\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classnetdem_1_1_shape_a731518cf0917f5af9e02b12adcb3d54a}{use\_customized\_solver}}\{\textcolor{keyword}{false}\};\ }
\DoxyCodeLine{00096\ \ \ \textcolor{comment}{//\ serialization\ and\ deserialization}}
\DoxyCodeLine{00101\ \textcolor{comment}{}\ \ \textcolor{keyword}{virtual}\ nlohmann::json\ \mbox{\hyperlink{classnetdem_1_1_shape_aaceb6d02ba07578916c4723eb14c1365}{PackJson}}();}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00107\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_shape_a01bdee57a765ce5432d16d9ef001c948}{InitFromJson}}(nlohmann::json\ \textcolor{keyword}{const}\ \&js);}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00113\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_shape_aec28148f9a8810c845121cdfbbe9e95d}{InitFromJsonFile}}(std::string\ \textcolor{keyword}{const}\ \&js\_file);}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00119\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_shape_a4891a52d4fc96c738c3ab208e4d884dd}{Translate}}(Vec3d\ \textcolor{keyword}{const}\ \&pos);}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00124\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_shape_a9f11fadd05e55890a9f90c676d0d1ae8}{UpdateNodes}}();}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00129\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_shape_a4286b79ebde34db279b1c13d167901ed}{UpdateShapeProperties}}();}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00135\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_shape_a83a4e08bc55fde5d3f99b5041efa6beb}{SetSize}}(\textcolor{keywordtype}{double}\ d);}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00141\ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classnetdem_1_1_shape}{Shape}}\ *\mbox{\hyperlink{classnetdem_1_1_shape_aa2f0bb26f5aa8f637a6bb3d5e735f45a}{Clone}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00148\ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classnetdem_1_1_s_t_l_model}{STLModel}}\ \mbox{\hyperlink{classnetdem_1_1_shape_ab3a616a53e637b4654fedf7ffd498f94}{GetSTLModel}}(\textcolor{keywordtype}{int}\ num\_facets\ =\ 400);}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00154\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_shape_a99ea5818f0b368e2d3c20bc9dcc51429}{SaveAsVTK}}(std::string\ \textcolor{keyword}{const}\ \&filename);}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00160\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_shape_a2eaa2d4c2021a7963cbfcc65d0f6cd41}{SaveAsSTL}}(std::string\ \textcolor{keyword}{const}\ \&filename);}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00168\ \ \ \textcolor{keyword}{virtual}\ std::tuple<Vec3d,\ Vec3d>\ \mbox{\hyperlink{classnetdem_1_1_shape_af06ef75dd2d9528a4206173902f868e9}{GetBoundAABB}}(Vec3d\ \textcolor{keyword}{const}\ \&pos,}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vec4d\ \textcolor{keyword}{const}\ \&quat);}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00176\ \ \ \textcolor{keyword}{virtual}\ Vec3d\ \mbox{\hyperlink{classnetdem_1_1_shape_a0cf9b4a6d035810b85aa24e118b81d1a}{SupportPoint}}(Vec3d\ \textcolor{keyword}{const}\ \&dir);}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00185\ \ \ \textcolor{keyword}{virtual}\ VecXT<Vec3d>\ \mbox{\hyperlink{classnetdem_1_1_shape_a15152dc02a9d8dfcae6a412e6f2131bd}{SupportPoints}}(Vec3d\ \textcolor{keyword}{const}\ \&dir);}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00193\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classnetdem_1_1_shape_aa27f20eb627e2e983ed530102eb91cdc}{SignedDistance}}(Vec3d\ \textcolor{keyword}{const}\ \&pos)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00201\ \ \ \textcolor{keyword}{virtual}\ Vec3d\ \mbox{\hyperlink{classnetdem_1_1_shape_a8528b3f4a6e03c5e83821c9842f596ac}{SurfacePoint}}(Vec3d\ \textcolor{keyword}{const}\ \&pos);}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00210\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classnetdem_1_1_shape_a31b9d4d6a5847de62aadc17a672b556f}{Enclose}}(Vec3d\ \textcolor{keyword}{const}\ \&pos);}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00215\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_shape_a5e11d9bc46005ddf54d7bff51024c2bb}{Print}}();}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00220\ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classnetdem_1_1_shape_a935afc9e576015f967d90de56977167d}{\string~Shape}}();}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00226\ \ \ MatNd<8,\ 3>\ \mbox{\hyperlink{classnetdem_1_1_shape_a91aa2921c75ed9fb0ec38ccacc4e6c13}{GetBoundAABBVertices}}();}
\DoxyCodeLine{00227\ \};}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \}\ \textcolor{comment}{//\ namespace\ netdem}}

\end{DoxyCode}
