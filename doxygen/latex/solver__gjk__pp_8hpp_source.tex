\hypertarget{solver__gjk__pp_8hpp_source}{}\doxysection{solver\+\_\+gjk\+\_\+pp.\+hpp}
\label{solver__gjk__pp_8hpp_source}\index{/Users/lzhshou/Documents/Research/myProjects/apaam/repo/netdem/src/dem/solver\_gjk\_pp.hpp@{/Users/lzhshou/Documents/Research/myProjects/apaam/repo/netdem/src/dem/solver\_gjk\_pp.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}collision\_geometries.hpp"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}collision\_solver\_pp.hpp"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}gjk\_simplex.hpp"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}particle.hpp"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}shape.hpp"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}wall.hpp"{}}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacenetdem}{netdem}}\ \{}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00015\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p}{SolverGJKPP}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classnetdem_1_1_collision_solver_p_p}{CollisionSolverPP}}\ \{}
\DoxyCodeLine{00016\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00017\ \ \ \textcolor{keywordtype}{double}\ erosion\_ratio\_initial\{0.01\},\ erosion\_ratio\_increment\{0.01\};}
\DoxyCodeLine{00018\ \ \ \textcolor{keywordtype}{bool}\ use\_erosion\{\textcolor{keyword}{false}\};}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00023\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_ad32ab545189294b53e40698a707fda98}{enalbe\_debugging}}\{\textcolor{keyword}{false}\};}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00028\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_abbcfc533b87b58663116db0ced702119}{enable\_logging}}\{\textcolor{keyword}{false}\};}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00033\ \ \ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a8ab629a416d72462db32d759ad6b80eb}{SolverGJKPP}}();}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a8ab629a416d72462db32d759ad6b80eb}{SolverGJKPP}}(\mbox{\hyperlink{classnetdem_1_1_particle}{Particle}}\ *\textcolor{keyword}{const}\ p1,\ \mbox{\hyperlink{classnetdem_1_1_particle}{Particle}}\ *\textcolor{keyword}{const}\ p2);}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00046\ \ \ \mbox{\hyperlink{classnetdem_1_1_collision_solver_p_p}{CollisionSolverPP}}\ *\mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a0caca1decfab6602c3e8f5f1c691e00a}{Clone}}()\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00053\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_ab651c60ac53f857232372faa3e7d2652}{Init}}(\mbox{\hyperlink{classnetdem_1_1_particle}{Particle}}\ *\textcolor{keyword}{const}\ p1,\ \mbox{\hyperlink{classnetdem_1_1_particle}{Particle}}\ *\textcolor{keyword}{const}\ p2)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00059\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a961ebc52e242d57fb32cd1a9f95dcf92}{Detect}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00066\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_ab6cc16826443f7e38a64efe2c136d4fb}{ResolveInit}}(\mbox{\hyperlink{classnetdem_1_1_contact_p_p}{ContactPP}}\ *\textcolor{keyword}{const}\ cnt,\ \textcolor{keywordtype}{double}\ timestep)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00073\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a316260af7610a6d9f090223dbd5f561a}{ResolveUpdate}}(\mbox{\hyperlink{classnetdem_1_1_contact_p_p}{ContactPP}}\ *\textcolor{keyword}{const}\ cnt,\ \textcolor{keywordtype}{double}\ timestep)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00081\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_ab6cc16826443f7e38a64efe2c136d4fb}{ResolveInit}}(\mbox{\hyperlink{classnetdem_1_1_collision_geometries}{CollisionGeometries}}\ *\textcolor{keyword}{const}\ cnt\_geoms,\ \textcolor{keywordtype}{double}\ timestep);}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00088\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a316260af7610a6d9f090223dbd5f561a}{ResolveUpdate}}(\mbox{\hyperlink{classnetdem_1_1_collision_geometries}{CollisionGeometries}}\ *\textcolor{keyword}{const}\ cnt\_geoms,\ \textcolor{keywordtype}{double}\ timestep);}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00091\ \ \ \mbox{\hyperlink{classnetdem_1_1_shape}{Shape}}\ *shape\_1\{\textcolor{keyword}{nullptr}\},\ *shape\_2\{\textcolor{keyword}{nullptr}\};}
\DoxyCodeLine{00092\ \ \ \textcolor{keywordtype}{double}\ bound\_sphere\_radius\_1,\ bound\_sphere\_radius\_2;}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ Vec3d\ dpos\_12,\ dpos\_12\_ref;}
\DoxyCodeLine{00095\ \ \ Vec4d\ dquat\_12,\ dquat\_12\_conj;}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ Simplex\ simplex\_after\_gjk;}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00103\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a2e805d594f4b3c6176d661a580795d17}{GJK}}();}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00110\ \ \ std::tuple<double,\ Vec3d,\ Vec3d>\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a18e35880d03142063713350066b6dc95}{GJK\_EROSION}}();}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00117\ \ \ std::tuple<double,\ Vec3d,\ Vec3d>\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a3ca7efb2f529ce5ab77c8dcb67df7aed}{EPA}}();}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00125\ \ \ std::tuple<Vec3d,\ bool>\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_aab1161404c701c9dfa5800b0bac485dc}{GetContactPoint}}(Vec3d\ \textcolor{keyword}{const}\ \&dir);}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00136\ \ \ std::tuple<Vec3d,\ bool>}
\DoxyCodeLine{00137\ \ \ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a1a3eec300cc7048fb3e737908b47b9e7}{GetContactPoint\_PlaneCase}}(Vec3d\ \textcolor{keyword}{const}\ \&dir,\ \textcolor{keyword}{const}\ VecXT<Vec3d>\ \&pos\_vec\_1,}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ VecXT<Vec3d>\ \&pos\_vec\_2);}
\DoxyCodeLine{00146\ \ \ \textcolor{keyword}{inline}\ Vec3d\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a6512977593bb42cd9dbcdce2bed8c1fe}{MinkowskiDiff}}(Vec3d\ \textcolor{keyword}{const}\ \&dir,\ \textcolor{keywordtype}{double}\ erosion\_ratio\ =\ 0);}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00155\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a8c452bbd00203639a86bbed5d80236aa}{UpdateSimplex}}(Simplex\ *\textcolor{keyword}{const}\ s,\ Vec3d\ *\textcolor{keyword}{const}\ dir,\ \textcolor{keywordtype}{double}\ *\textcolor{keyword}{const}\ min\_dist,}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ *\textcolor{keyword}{const}\ cnt\_flag);}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00165\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a28121af7b65d20352965e8f6f352ca05}{UpdateSimplexLine}}(Simplex\ *\textcolor{keyword}{const}\ s,\ Vec3d\ *\textcolor{keyword}{const}\ dir,}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *\textcolor{keyword}{const}\ min\_dist,\ \textcolor{keywordtype}{bool}\ *\textcolor{keyword}{const}\ cnt\_flag);}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00175\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_af3474d50da13c65c597a60898c9a9380}{UpdateSimplexTriangle}}(Simplex\ *\textcolor{keyword}{const}\ s,\ Vec3d\ *\textcolor{keyword}{const}\ dir,}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *\textcolor{keyword}{const}\ min\_dist,\ \textcolor{keywordtype}{bool}\ *\textcolor{keyword}{const}\ cnt\_flag);}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00185\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_af6d9cfa6c52775653cd9411a25abd059}{UpdateSimplexTetrahedron}}(Simplex\ *\textcolor{keyword}{const}\ s,\ Vec3d\ *\textcolor{keyword}{const}\ dir,}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *\textcolor{keyword}{const}\ min\_dist,\ \textcolor{keywordtype}{bool}\ *\textcolor{keyword}{const}\ cnt\_flag);}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00196\ \ \ \textcolor{keyword}{inline}\ std::tuple<Vec3d,\ double>}
\DoxyCodeLine{00197\ \ \ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a09347fa18b3834b5dfd296d0bf7e6a40}{GetFacetNormal}}(Vec3d\ \textcolor{keyword}{const}\ \&a,\ Vec3d\ \textcolor{keyword}{const}\ \&b,\ Vec3d\ \textcolor{keyword}{const}\ \&c);}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00205\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a3edf26b2c2b64f3fb5271fdbd09c85cd}{GetLooseEdges}}(VecXT<Vec2i>\ *\textcolor{keyword}{const}\ edges,\ Vec3i\ \textcolor{keyword}{const}\ \&facet);}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00216\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_ad1a0c84c84ec5b67c469b582f15d8af9}{GetIntersections}}(VecXT<Vec3d>\ *\textcolor{keyword}{const}\ intersects,\ Vec3d\ \textcolor{keyword}{const}\ \&dir\_n,}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vec3d\ \textcolor{keyword}{const}\ \&l1\_p1,\ Vec3d\ \textcolor{keyword}{const}\ \&l1\_p2,}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vec3d\ \textcolor{keyword}{const}\ \&l2\_p1,\ Vec3d\ \textcolor{keyword}{const}\ \&l2\_p2);}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00230\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a5d5220bf131bfbbfa785fefee5b23664}{GetIntersectionsAggresive}}(VecXT<Vec3d>\ *\textcolor{keyword}{const}\ intersects,}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vec3d\ \textcolor{keyword}{const}\ \&dir\_n,\ Vec3d\ \textcolor{keyword}{const}\ \&l1\_p1,}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vec3d\ \textcolor{keyword}{const}\ \&l1\_p2,\ Vec3d\ \textcolor{keyword}{const}\ \&l2\_p1,}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vec3d\ \textcolor{keyword}{const}\ \&l2\_p2);}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00241\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a4e9171e68bd6a2acaefec79edc2bc890}{SortVertices}}(VecXT<Vec3d>\ *\textcolor{keyword}{const}\ pos\_vec,\ Vec3d\ \textcolor{keyword}{const}\ \&dir\_n);}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00250\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_a34f131034fc9d1e939911e9087773249}{IsInsidePolygon}}(VecXT<Vec3d>\ \textcolor{keyword}{const}\ \&pos\_vec,\ Vec3d\ \textcolor{keyword}{const}\ \&dir\_n,}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vec3d\ \textcolor{keyword}{const}\ \&pos);}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00259\ \ \ Vec3d\ \mbox{\hyperlink{classnetdem_1_1_solver_g_j_k_p_p_ad95a7f1e4fb67f1e96fedba43968a8ef}{GetPolygonCentroid}}(VecXT<Vec3d>\ \textcolor{keyword}{const}\ \&pos\_vec,\ Vec3d\ \textcolor{keyword}{const}\ \&dir\_n);}
\DoxyCodeLine{00260\ \};}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \}\ \textcolor{comment}{//\ namespace\ netdem}}

\end{DoxyCode}
