<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="https://net-dem.github.io/netdem_docs/img/favicon.ico">
        <meta name="keywords" content="Finite Element Library,Finite Element Code,Finite Element Method Library,Finite Element Method Code,Finite Element C++,Finite Element Method C++,Finite Element Library C++,Finite Element Code C++,FEM Code,FEM Library,FEM C++">
        <meta name="google-site-verification" content="45K56TawSdzbgy-uDtfJdYwp7zaVdL3fIAGYt869wwU" />
<!--	<title></title>  -->
        <title>NetDEM - Neural Network Enabled Discret Element Method</title>

        <link href="../../css/bootstrap-netdem.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/highlight.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="https://net-dem.github.io/netdem_docs/">NetDEM</a>
        </div>

        <script>var base_url = '../..';</script>
        <!-- <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script> -->

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li >
                                 <a href="../../examples/random_packing/">Random packing</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../examples/triaxial_compression/">Triaxial compression</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../examples/angle_of_repose/">Angle of repose</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../examples/granular_mixing/">Granular mixing</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li class="active">
                                 <a href="./">User manual</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../developer_manual/">Developer manual</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../dem_formulations/">DEM formulations</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../doxygen/html/">Code doxygen</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../../download/">Download</a>
                </li>
            
            
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Gallery <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li >
                                 <a href="../../gallery/snapshots/">Snapshots</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../gallery/animations/">Animations</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li >
                                 <a href="../../about/news_%26_updates/">News & Updates</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../about/help_%26_support/">Help & Support</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../about/publications/">Publications</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../about/acknowledgement/">Acknowledgements</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li class="nav-item">
                    <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                
                <li>
                    <a href="https://github.com/net-dem/netdem_docs/">
                        
                            <i class="fa fa-github-square"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        
        <div class="container">
            
            <div class="col-md-3 visible-xs visible-sm"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#_1"></a></li>
        
    
        <li class="main "><a href="#installation">Installation</a></li>
        
            <li><a href="#prerequisites"> &#9731; Prerequisites</a></li>
        
            <li><a href="#compile-and-build"> &#9731; Compile and build</a></li>
        
            <li><a href="#test-the-installation"> &#9731; Test the installation</a></li>
        
    
        <li class="main "><a href="#related-to-installation">Related to installation</a></li>
        
            <li><a href="#installation-on-apple-m1"> &#9731; Installation on Apple M1</a></li>
        
            <li><a href="#dependencies"> &#9731; Dependencies</a></li>
        
    
        <li class="main "><a href="#basic-usage">Basic usage</a></li>
        
            <li><a href="#run-built-in-examples"> &#9731; Run built-in examples</a></li>
        
            <li><a href="#reconstruct-mesh-of-particles-and-walls"> &#9731; Reconstruct mesh of particles and walls</a></li>
        
            <li><a href="#customized-simulation"> &#9731; Customized simulation</a></li>
        
    
        <li class="main "><a href="#visualize-in-paraview">Visualize in paraview</a></li>
        
            <li><a href="#spherical-particles"> &#9731; Spherical particles</a></li>
        
            <li><a href="#general-particles-and-walls"> &#9731; General particles and walls</a></li>
        
            <li><a href="#contact-force-chain"> &#9731; Contact force chain</a></li>
        
            <li><a href="#ray-tracing"> &#9731; Ray tracing</a></li>
        
            <li><a href="#create-animation"> &#9731; Create animation</a></li>
        
    
        <li class="main "><a href="#post-process">Post-process</a></li>
        
    
    </ul>
</div></div> <!-- toc on top on mobile -->
            <div class="col-md-3 hidden-xs hidden-sm"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#_1"></a></li>
        
    
        <li class="main "><a href="#installation">Installation</a></li>
        
            <li><a href="#prerequisites"> &#9731; Prerequisites</a></li>
        
            <li><a href="#compile-and-build"> &#9731; Compile and build</a></li>
        
            <li><a href="#test-the-installation"> &#9731; Test the installation</a></li>
        
    
        <li class="main "><a href="#related-to-installation">Related to installation</a></li>
        
            <li><a href="#installation-on-apple-m1"> &#9731; Installation on Apple M1</a></li>
        
            <li><a href="#dependencies"> &#9731; Dependencies</a></li>
        
    
        <li class="main "><a href="#basic-usage">Basic usage</a></li>
        
            <li><a href="#run-built-in-examples"> &#9731; Run built-in examples</a></li>
        
            <li><a href="#reconstruct-mesh-of-particles-and-walls"> &#9731; Reconstruct mesh of particles and walls</a></li>
        
            <li><a href="#customized-simulation"> &#9731; Customized simulation</a></li>
        
    
        <li class="main "><a href="#visualize-in-paraview">Visualize in paraview</a></li>
        
            <li><a href="#spherical-particles"> &#9731; Spherical particles</a></li>
        
            <li><a href="#general-particles-and-walls"> &#9731; General particles and walls</a></li>
        
            <li><a href="#contact-force-chain"> &#9731; Contact force chain</a></li>
        
            <li><a href="#ray-tracing"> &#9731; Ray tracing</a></li>
        
            <li><a href="#create-animation"> &#9731; Create animation</a></li>
        
    
        <li class="main "><a href="#post-process">Post-process</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h3 id="_1"></h3>
<h3 id="installation">Installation</h3>
<h4 id="prerequisites">Prerequisites</h4>
<p>The compilation requires <code>gcc</code>, <code>autoconf</code>, <code>automake</code>, <code>cmake</code>, <code>mpi</code>, <code>boost</code>, which can be obtained using</p>
<pre><code># For MacOS: use brew install, such as
brew install gcc autoconf automake cmake openmpi boost

# For Ubuntu: use apt-get install, such as
sudo apt install build-essential
sudo apt-get install -y autoconf-archive automake cmake texinfo
sudo apt-get install openmpi-bin libopenmpi-dev libboost-all-dev
</code></pre>
<h4 id="compile-and-build">Compile and build</h4>
<pre><code>make sync_submodule
make
</code></pre>
<p>If some third-party libraries have not been or cannot be downloaded successfully, you can delete them and do a <code>git checkout contrib</code> and <code>make sync_submodule</code> again.</p>
<h4 id="test-the-installation">Test the installation</h4>
<pre><code>./scripts/run_tests.sh
</code></pre>
<h3 id="related-to-installation">Related to installation</h3>
<h4 id="installation-on-apple-m1">Installation on Apple M1</h4>
<p>(As of Dec. 20 2021)</p>
<p>OpenMP seems not compitible with Apple M1. To enforce an OpenMP installation, set <code>USE_INTERNAL_OPENMP</code> in netdem <code>CMakeLists.txt</code> to <code>OFF</code>, and use <code>brew install libomp</code> to install a pre-built copy of OpenMP.</p>
<p>Add M1 support to <code>fast_winding_number</code> functional in <code>igl</code> via <code>SIMDE</code> (please see the discussion in <a href="https://github.com/sideeffects/WindingNumber/pull/3/files">https://github.com/sideeffects/WindingNumber/pull/3/files</a>): </p>
<ul>
<li>Install simde using <code>brew install simde</code>.</li>
<li>Add <code>-flax-vector-conversions</code> to the gcc complier flag in netdem <code>CMakeLists.txt</code>.</li>
<li>Add the following lines to the <code>FastWindingNumberForSoups</code> in igl and comment out the <code>#include &lt;emmintrin.h&gt;</code> line.</li>
</ul>
<pre><code>#define SIMDE_ENABLE_NATIVE_ALIASES
#include &lt;simde/x86/sse.h&gt;
#include &lt;simde/x86/sse4.1.h&gt;

// Recent GCC define the macro in x86intrin.h
#ifndef _MM_MK_INSERTPS_NDX
#define _MM_MK_INSERTPS_NDX(srcField, dstField, zeroMask) (((srcField)&lt;&lt;6) | ((dstField)&lt;&lt;4) | (zeroMask))
#endif
</code></pre>
<p>Build netdem following the original procedures.</p>
<h4 id="dependencies">Dependencies</h4>
<ul>
<li><a href="https://git-scm.com">git</a>, <a href="https://gcc.gnu.org">gcc</a>, <a href="https://cmake.org">cmake</a>: for code developing, configuring and compiling</li>
<li><a href="https://www.open-mpi.org">open mpi</a>: for parallel computing</li>
<li><a href="https://github.com/ArthurSonzogni/nlohmann_json_cmake_fetchcontent.git">json</a>: for input data interchange</li>
<li><a href="https://github.com/libigl/cork.git">cork</a>: for mesh boolean operation<ul>
<li><a href="https://gmplib.org">gmp</a></li>
</ul>
</li>
<li><a href="https://github.com/libigl/libigl.git">igl</a>: another option of mesh boolean operation (robust but much slower than cork)<ul>
<li><a href="https://github.com/CGAL/cgal.git">cgal</a> (requires <a href="https://github.com/boostorg/boost.git">boost</a>, <a href="https://gmplib.org">gmp</a>, <a href="https://www.mpfr.org">mpfr</a>), <a href="https://openmp.llvm.org/">openmp</a>, <a href="https://gitlab.com/libeigen/eigen.git">eigen</a></li>
</ul>
</li>
<li><a href="https://github.com/google/googletest.git">googletest</a>: for tests</li>
<li><a href="https://github.com/mlpack/mlpack.git">mlpack</a>: for machine learning libraries<ul>
<li><a href="http://arma.sourceforge.net/download.html">armadillo</a> (requires <a href="https://github.com/Reference-LAPACK/lapack.git">lapack</a>, <a href="https://github.com/opencollab/arpack-ng.git">arpack</a>, <a href="https://github.com/xianyi/OpenBLAS.git">openblas</a>), <a href="https://github.com/mlpack/ensmallen">ensmallen</a>, <a href="https://github.com/USCiLab/cereal">cereal</a>, <a href="https://github.com/boostorg/boost.git">boost</a>, <a href="https://github.com/nothings/stb.git">stb</a></li>
</ul>
</li>
<li><a href="https://github.com/pybind/pybind11.git">pybind</a>: for python interface </li>
</ul>
<p>Using dependencies already in the system would save the time required by the compilation of the whole project. Some dependencies (e.g., mlpack) would take fairly long time to compile. One can check out the log files in contrib/[package]/ep/src/[package]-stamp/ for the compiling, building and installing progresses of the dependencies. Some packages (e.g., <code>boost</code> and <code>mpi</code>) could take forever to compile. It is recommended that you install pre-build <code>boost</code> and <code>mpi</code> using tools such as <code>brew install</code> in mac os, or <code>apt-get install</code> in ubantu.</p>
<h3 id="basic-usage">Basic usage</h3>
<h4 id="run-built-in-examples">Run built-in examples</h4>
<p>There are some built-in examples defined in the <code>examples/</code> directory. Once the software is installed, it will create an excutable file in the <code>build/bin</code> directory. </p>
<p>Run an example using the following command in the root directory. The results will be stored in <code>tmp/out/</code> directory after the running of the example, and can be visualized in <a href="https://www.paraview.org">paraview</a>.</p>
<pre><code>./build/bin/netdem_example_random_packing
</code></pre>
<pre><code>python3 example/00_random_packing/pynetdem_1_gjk_solver.py
</code></pre>
<h4 id="reconstruct-mesh-of-particles-and-walls"><a name="recon_mesh_ref"></a>Reconstruct mesh of particles and walls</h4>
<p>For irregular-shaped particles, use the following command to generate the results with particles represented by triangle meshes.</p>
<pre><code>./build/bin/netdem_tool_point2mesh [in.vtk] [out.vtk] [shape_dir]
</code></pre>
<p>In case one need to do the generation in batch, the following command can be used</p>
<pre><code>./scripts/batch_data_point2mesh.sh [in_dir] [out_dir] [shape_dir]
</code></pre>
<p>or easier</p>
<pre><code>./scripts/auto_mesh_particle.sh [out_dir]
./scripts/auto_mesh_wall.sh [out_dir]
</code></pre>
<h4 id="customized-simulation">Customized simulation</h4>
<p>Please follow the built-in examples to write the c++ or python scripts.</p>
<h3 id="visualize-in-paraview">Visualize in paraview</h3>
<p>Results can be dumped as VTK files, which can be visualized in <a href="https://www.paraview.org/">paraview</a>.</p>
<h4 id="spherical-particles">Spherical particles</h4>
<ul>
<li>Import particle info into paraview;</li>
<li>Set <code>Representation</code> to <code>Point Gaussian</code>, and adjust the radius;</li>
<li>In case particles are of various sizes, enable <code>Toggle advanced properties</code>, enable <code>Use Scale Array</code>, select the proper <code>Scale Array Component</code>, and adjust the <code>Range</code>.</li>
</ul>
<h4 id="general-particles-and-walls">General particles and walls</h4>
<ul>
<li><a href="#recon_mesh_ref">Reconstruc the mesh of particles and walls</a>;</li>
<li>Import to praview;</li>
</ul>
<h4 id="contact-force-chain">Contact force chain</h4>
<ul>
<li>Enable dump contact force by set: <code>data_dump.dump_contact_info = true</code>;</li>
<li>Import contact info into paraview;</li>
<li>Add a <code>tube</code> filter to the contact force data in paraview, and adjust the radius of the contact tubes.</li>
</ul>
<h4 id="ray-tracing">Ray tracing</h4>
<ul>
<li><code>Enable Ray Tracing</code> at the end of Properties section;</li>
<li>Change the <code>Back end</code> to <code>OsPRay pathtracer</code>;</li>
<li>Increase the <code>Samples Per Pixel</code>, which gives fair results with a value 5 in reasonble rendering time;</li>
<li>Set the <code>Background mode</code> to <code>Backplase</code>, which is while as suggested.</li>
<li>One can play with the <code>Material</code> options in the middle-while of the Properties section.</li>
</ul>
<h4 id="create-animation">Create animation</h4>
<ul>
<li>In paraview, go <code>File</code> &rarr; <code>Save Animation</code>;</li>
<li>Select the <code>avi</code> option and specify the name;</li>
<li>Suggest to set the image resolution with <code>1920 x 1080</code>, i.e., 1080p, and Set the Frame Rate to <code>24</code> (a minimal value to give fluent animation);</li>
<li>Compress the avi animation with third-party tools, such as <code>ffmpeg</code> or <code>Tencent Cloud</code>;<ul>
<li>For <code>Tencent Cloud</code>, suggested procedures (in Chinese):</li>
<li>选择云产品<code>云点播</code>，在<code>媒资管理</code> &rarr; <code>音视频管理</code>中，上传视频;</li>
<li>上传视频后，选择待处理的视频，进行<code>视频处理</code>，建议选择<code>TESHD-H264-MP4-720P</code>转码模板;</li>
<li>点击右侧的<code>管理</code>，可查看视频封面和视频播放地址等链接，可用于网页制作.</li>
</ul>
</li>
</ul>
<h3 id="post-process">Post-process</h3>
<p>We have a <a href="https://github.com/net-dem/dem_postprocess_scripts">side-repository</a> that provides some matlab or python scripts for post-process (e.g., VTK io, stress-strain, spherical histograms of contact anisotropy).</p></div>
            <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>Enter your search keywords below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
            
        </div>
        

        <footer class="footer">
           <div class="container">
              <p class="text-muted alignleft">
                  <span id="busuanzi_container_site_uv">Vistors: <span id="busuanzi_value_site_uv"></span>. </span>
              </p>
              <p class="text-muted alignright">
                &copy; <a href="https://net-dem.github.io/netdem_docs/about/acknowledgement/">NetDEM Team</a>. SYSU, HKUST.
              </p>
           </div>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../js/retina.min.js"></script>
        <!-- <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script> -->
        <script src="../../mathjax-config.js"></script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <script src="../../search/main.js"></script>
    </body>
</html>